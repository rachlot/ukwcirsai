{
    "ID": "CIRS",
    "layout": {
        "widget": "page",
        "children": [
            {
                "widget": "container",
                "children": [
                    {
                        "html": "Beispiel\n<pre>gestern wurde einer achzigjährigen patientin in der augenklinik vesehentlich ein falsches antibiotika gegeben</pre>",
                        "widget": "html"
                    },
                    {
                        "title": "Geben Sie Ihren Bericht ein",
                        "text": "Analysieren",
                        "expression": "{\n  \"bericht\": variable.bericht\n}",
                        "print": "(\n\n$x := $curl(\"POST\", \"https://api.openai.com/v1/chat/completions\", {\n    \"model\": \"gpt-4o-mini\",\n    \"response_format\": { \"type\": \"json_object\" },\n    \"messages\": [\n      {\n        \"role\": \"system\",\n        \"content\": \"Deine Aufgabe ist es, einen Bericht in ein JSON Objekt zu übersetzen. Nutze dazu lediglich die Informationen der Eingabe. Fehlt eine Information in der Eingabe, nutze den Wert 'unbekannt'. Füge die folgenden felder hinzu:\\n\\n\" &\n          \"Zuständiges Fachgebiet\\n\" &\n          \"Altersgruppe des Patienten\\n\" &\n          \"Geschlecht des Patienten\\n\" &\n          \"Wo ist das Ereignis passiert\\n\" &\n          \"Welche Versorgungsart\\n\" &\n          \"In welchem Kontext fand das Ereignis statt\\n\" &\n          \"Was ist passiert\\n\" &\n          \"Was war das Ergebnis\\n\" &\n          \"Wo sehen Sie Gründe für dieses Ereignis und wie hätte es vermieden werden können\\n\" &\n          \"Kam der Patient zu Schaden\\n\" &\n          \"Welche Faktoren trugen zu dem Ereignis bei\\n\" &\n          \"Wie häufig tritt dieses Ereignis ungefähr auf\\n\" &\n          \"Wer berichtet\\n\" &\n          \"Zusätzliche Bemerkungen\\n\"\n      },\n      {\n        \"role\": \"user\",\n        \"content\": form.bericht\n      }\n    ]\n }, {\"Authorization\": \"openai\"}).choices[0].message.content;\n\n$setVariable(\"cirs\", $parseJson($x));\n$setVariable(\"bericht\", form.bericht);\n$refresh()\n\n)",
                        "widget": "button",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "bericht": {
                                    "widget": "textarea",
                                    "style": {
                                        "width": "800px"
                                    }
                                }
                            }
                        }
                    }
                ]
            },
            {
                "display": "variable.cirs",
                "title": "CIRS Struktur",
                "widget": "display",
                "size": 6
            },
            {
                "text": "Speichern",
                "expression": "variable.cirs",
                "print": "form",
                "title": "Vorschau",
                "widget": "button",
                "size": 6,
                "schema": {
                    "type": "object",
                    "properties": {
                        "Zuständiges Fachgebiet": {},
                        "Altersgruppe des Patienten": {}
                    }
                }
            }
        ]
    }
}